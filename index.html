<!DOCTYPE html>
<html>
  <head>
    <style type="text/css">
      html, body { height: 100%; margin: 0; padding: 0; }
      #map { height: 100%; }
    </style>
  </head>
  <body>
    <div id="map"></div>
    <script type="text/javascript">

    var map;
    function initMap() {
      var geocoder = new google.maps.Geocoder();
      var address = "Portland";
      geocoder.geocode({'address': address}, function (results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
          var latLng = new google.maps.LatLng(results[0].geometry.location.lat(), 
            results[0].geometry.location.lng());

          map = new google.maps.Map(document.getElementById('map'), {
            center: latLng,
            zoom: 12
          });

          map.addListener('click', function (event) {
            alert(event.latLng);
            geocoder.geocode({"location": event.latLng}, function (results, status) {
              if (status == google.maps.GeocoderStatus.OK) {
                var address_components = results[0].address_components;

                var postal_code = undefined;
                for (var i = 0; i < address_components.length; ++i) {
                  if (address_components[i]["types"] == "postal_code")
                    postal_code = address_components[i]["long_name"];
                }

                alert(postal_code);

                var marker = new google.maps.Marker({
                  position: event.latLng,
                  map: map,
                  title: "Hello World!"
                });
              }
            });
          });

        }
      });
    }

    function covert_to_crime_by_zipcode(data) {
      var crime_by_zipcode = {};
      for (var i = 0; i < data.length; ++i) {
        var address = data[i][4];
        var zipcode = address.slice(address.length - 5);
        if ((zipcode in crime_by_zipcode) == false) 
          crime_by_zipcode[zipcode] = {};
        crime_type = data[i][3];
        if ((crime_type in crime_by_zipcode[zipcode]) == false)
          crime_by_zipcode[zipcode][crime_type] = 0;
        crime_by_zipcode[zipcode][crime_type]++;
      }
      return crime_by_zipcode;
    }

    </script>
    <script async defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBbCPplHphEq_SdUfv-BfeNyoI-5yi8uks&callback=initMap">
    </script>
  </body>
</html>