<!DOCTYPE html>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<html>
  <head>
    <style type="text/css">
      html, body { height: 100%; margin: 0; padding: 0; }
      #map { height: 100%; }
    </style>
  </head>
  <body>
    <div id="map"></div>
    <script type="text/javascript">

    var crime_by_zipcode = undefined;
    var json_string = '{"97024": {"Fraud": 2, "Trespass": 1, "Drugs": 1, "DUII": 1, "Weapons": 1, "Larceny": 2, "Vandalism": 1, "Disorderly Conduct": 1}, "97027": {"Forgery": 1}, "97030": {"Disorderly Conduct": 2, "Larceny": 9, "Fraud": 11, "Liquor Laws": 1, "Forgery": 41, "Drugs": 13, "DUII": 6, "Assault, Simple": 2, "Stolen Property": 3, "Trespass": 5, "Aggravated Assault": 1, "Vandalism": 2, "Burglary": 1, "Motor Vehicle Theft": 1}, "97217": {"Homicide": 24, "DUII": 1225, "Weapons": 234, "Forgery": 884, "Vandalism": 3412, "Gambling": 2, "Curfew": 144, "Disorderly Conduct": 1508, "Offenses Against Family": 1, "Liquor Laws": 900, "Trespass": 1558, "Drugs": 1852, "Assault, Simple": 1416, "Stolen Property": 54, "Aggravated Assault": 974, "Burglary": 3239, "Fraud": 1518, "Arson": 23, "Larceny": 14906, "Robbery": 805, "Prostitution": 22, "Motor Vehicle Theft": 2833, "Embezzlement": 188, "Sex Offenses": 23, "Rape": 10, "Kidnap": 17, "Runaway": 6}, "97034": {"Larceny": 6, "DUII": 1, "Embezzlement": 1, "Forgery": 1, "Vandalism": 3, "Burglary": 4}, "97035": {"Fraud": 5, "Forgery": 1, "Drugs": 1, "DUII": 1, "Assault, Simple": 1, "Larceny": 13, "Vandalism": 12, "Burglary": 7}, "97045": {"Drugs": 2, "Forgery": 11, "Fraud": 2, "DUII": 1}, "97051": {"Fraud": 1}, "97055": {"Drugs": 1, "Trespass": 1}, "97056": {"Forgery": 1}, "97086": {"Larceny": 7, "Fraud": 2, "Forgery": 2, "Drugs": 4, "DUII": 2, "Prostitution": 1, "Motor Vehicle Theft": 1, "Embezzlement": 1, "Trespass": 1, "Aggravated Assault": 1, "Robbery": 1, "Burglary": 1}, "97060": {"Fraud": 2, "Larceny": 2, "Drugs": 2, "DUII": 2, "Trespass": 3, "Weapons": 1, "Forgery": 29, "Disorderly Conduct": 2}, "97062": {"Trespass": 1, "Larceny": 1, "Fraud": 1, "Prostitution": 1, "Forgery": 11}, "97068": {"Trespass": 2, "Larceny": 1}, "97070": {"Embezzlement": 1, "Forgery": 5}, "97201": {"Homicide": 2, "DUII": 378, "Weapons": 37, "Forgery": 167, "Vandalism": 1366, "Gambling": 1, "Curfew": 3, "Disorderly Conduct": 660, "Offenses Against Family": 1, "Liquor Laws": 535, "Trespass": 727, "Drugs": 369, "Assault, Simple": 494, "Stolen Property": 11, "Aggravated Assault": 217, "Burglary": 920, "Fraud": 427, "Arson": 7, "Larceny": 7520, "Robbery": 200, "Prostitution": 10, "Motor Vehicle Theft": 840, "Embezzlement": 51, "Sex Offenses": 22, "Kidnap": 2, "Rape": 6}, "97202": {"Homicide": 1, "DUII": 1021, "Weapons": 87, "Forgery": 509, "Vandalism": 3218, "Curfew": 10, "Disorderly Conduct": 799, "Offenses Against Family": 4, "Liquor Laws": 443, "Trespass": 792, "Drugs": 788, "Assault, Simple": 820, "Stolen Property": 23, "Aggravated Assault": 421, "Burglary": 3146, "Fraud": 1074, "Arson": 20, "Larceny": 11949, "Robbery": 357, "Prostitution": 4, "Motor Vehicle Theft": 2492, "Embezzlement": 75, "Sex Offenses": 36, "Runaway": 6, "Kidnap": 5, "Rape": 9}, "97203": {"Homicide": 15, "DUII": 939, "Weapons": 168, "Forgery": 496, "Vandalism": 3397, "Curfew": 116, "Disorderly Conduct": 1367, "Offenses Against Family": 1, "Liquor Laws": 729, "Sex Offenses": 21, "Drugs": 919, "Assault, Simple": 1484, "Stolen Property": 53, "Aggravated Assault": 887, "Burglary": 2618, "Fraud": 829, "Arson": 39, "Larceny": 9628, "Robbery": 535, "Prostitution": 6, "Motor Vehicle Theft": 2267, "Embezzlement": 82, "Trespass": 1389, "Rape": 5, "Kidnap": 16, "Runaway": 9}, "97204": {"Homicide": 13, "DUII": 739, "Weapons": 149, "Forgery": 436, "Vandalism": 1202, "Gambling": 2, "Curfew": 67, "Disorderly Conduct": 2450, "Offenses Against Family": 2, "Liquor Laws": 4538, "Trespass": 2397, "Drugs": 3021, "Assault, Simple": 1555, "Stolen Property": 47, "Aggravated Assault": 731, "Burglary": 367, "Fraud": 540, "Arson": 25, "Larceny": 7325, "Robbery": 579, "Prostitution": 37, "Motor Vehicle Theft": 659, "Embezzlement": 76, "Sex Offenses": 48, "Rape": 14, "Kidnap": 5, "Runaway": 3}, "97205": {"Homicide": 5, "DUII": 381, "Weapons": 107, "Forgery": 244, "Vandalism": 1387, "Curfew": 23, "Disorderly Conduct": 1261, "Offenses Against Family": 3, "Liquor Laws": 1812, "Trespass": 1251, "Drugs": 1482, "Assault, Simple": 1031, "Stolen Property": 34, "Aggravated Assault": 342, "Burglary": 722, "Fraud": 516, "Arson": 17, "Larceny": 8177, "Robbery": 399, "Prostitution": 18, "Motor Vehicle Theft": 689, "Embezzlement": 88, "Sex Offenses": 43, "Rape": 4, "Kidnap": 6, "Runaway": 7}, "97206": {"Homicide": 17, "DUII": 957, "Weapons": 201, "Forgery": 585, "Vandalism": 4397, "Gambling": 1, "Curfew": 38, "Disorderly Conduct": 1145, "Offenses Against Family": 4, "Liquor Laws": 363, "Sex Offenses": 37, "Drugs": 1419, "Assault, Simple": 1364, "Stolen Property": 44, "Aggravated Assault": 739, "Burglary": 4473, "Fraud": 1172, "Arson": 22, "Larceny": 12525, "Robbery": 538, "Prostitution": 115, "Motor Vehicle Theft": 2974, "Embezzlement": 61, "Trespass": 1116, "Runaway": 11, "Kidnap": 22, "Rape": 18}, "97207": {"Fraud": 1, "Liquor Laws": 8, "Vandalism": 1, "Trespass": 13, "Drugs": 2, "DUII": 2, "Assault, Simple": 7, "Motor Vehicle Theft": 3, "Larceny": 16, "Aggravated Assault": 1, "Robbery": 1, "Burglary": 1, "Disorderly Conduct": 2}, "97080": {"Fraud": 5, "Larceny": 5, "Drugs": 5, "Assault, Simple": 1, "Prostitution": 1, "Stolen Property": 1, "Forgery": 38}, "97209": {"Homicide": 10, "DUII": 1043, "Weapons": 237, "Forgery": 410, "Vandalism": 2428, "Gambling": 1, "Curfew": 20, "Disorderly Conduct": 3084, "Offenses Against Family": 3, "Liquor Laws": 6294, "Trespass": 4220, "Drugs": 6057, "Assault, Simple": 2546, "Stolen Property": 54, "Aggravated Assault": 1143, "Burglary": 1139, "Fraud": 777, "Arson": 29, "Larceny": 14458, "Robbery": 754, "Prostitution": 272, "Motor Vehicle Theft": 1557, "Embezzlement": 74, "Sex Offenses": 66, "Rape": 28, "Kidnap": 8, "Runaway": 4}, "97210": {"Homicide": 1, "DUII": 297, "Weapons": 13, "Forgery": 199, "Vandalism": 907, "Gambling": 1, "Curfew": 1, "Disorderly Conduct": 324, "Liquor Laws": 531, "Trespass": 378, "Drugs": 172, "Assault, Simple": 267, "Stolen Property": 3, "Aggravated Assault": 115, "Burglary": 1018, "Fraud": 355, "Arson": 8, "Larceny": 5247, "Robbery": 110, "Prostitution": 11, "Motor Vehicle Theft": 860, "Embezzlement": 66, "Sex Offenses": 8, "Runaway": 1, "Kidnap": 1, "Rape": 3}, "97211": {"Homicide": 12, "DUII": 837, "Weapons": 240, "Forgery": 452, "Vandalism": 3135, "Gambling": 6, "Curfew": 142, "Disorderly Conduct": 1031, "Offenses Against Family": 2, "Liquor Laws": 247, "Trespass": 1034, "Drugs": 1205, "Assault, Simple": 1066, "Stolen Property": 16, "Aggravated Assault": 774, "Burglary": 3113, "Fraud": 913, "Arson": 23, "Larceny": 9126, "Robbery": 503, "Prostitution": 31, "Motor Vehicle Theft": 1598, "Embezzlement": 76, "Sex Offenses": 26, "Runaway": 15, "Kidnap": 7, "Rape": 25}, "97212": {"Homicide": 2, "DUII": 465, "Weapons": 68, "Forgery": 217, "Vandalism": 2075, "Gambling": 1, "Curfew": 25, "Disorderly Conduct": 528, "Offenses Against Family": 2, "Liquor Laws": 520, "Sex Offenses": 20, "Drugs": 1009, "Assault, Simple": 533, "Stolen Property": 11, "Aggravated Assault": 328, "Burglary": 2141, "Fraud": 556, "Arson": 13, "Larceny": 7227, "Robbery": 320, "Prostitution": 16, "Motor Vehicle Theft": 1124, "Embezzlement": 35, "Trespass": 663, "Runaway": 5, "Kidnap": 9, "Rape": 9}, "97213": {"Homicide": 3, "DUII": 553, "Weapons": 74, "Forgery": 539, "Vandalism": 2325, "Curfew": 22, "Disorderly Conduct": 644, "Liquor Laws": 346, "Trespass": 712, "Drugs": 530, "Assault, Simple": 601, "Stolen Property": 12, "Aggravated Assault": 344, "Burglary": 2465, "Fraud": 877, "Arson": 8, "Larceny": 8426, "Robbery": 411, "Prostitution": 233, "Motor Vehicle Theft": 1910, "Embezzlement": 60, "Sex Offenses": 30, "Rape": 13, "Kidnap": 6, "Runaway": 12}, "97214": {"Homicide": 5, "DUII": 1561, "Weapons": 107, "Forgery": 760, "Vandalism": 4158, "Curfew": 14, "Disorderly Conduct": 1266, "Offenses Against Family": 1, "Liquor Laws": 2333, "Trespass": 1661, "Drugs": 1208, "Assault, Simple": 1055, "Stolen Property": 31, "Aggravated Assault": 625, "Burglary": 2290, "Fraud": 962, "Arson": 79, "Larceny": 14286, "Robbery": 418, "Prostitution": 37, "Motor Vehicle Theft": 2149, "Embezzlement": 120, "Sex Offenses": 71, "Runaway": 20, "Kidnap": 5, "Rape": 19}, "97215": {"Homicide": 1, "DUII": 377, "Weapons": 32, "Forgery": 129, "Vandalism": 1198, "Curfew": 11, "Disorderly Conduct": 270, "Offenses Against Family": 3, "Liquor Laws": 189, "Sex Offenses": 11, "Drugs": 263, "Assault, Simple": 273, "Stolen Property": 7, "Aggravated Assault": 167, "Burglary": 1212, "Fraud": 289, "Arson": 14, "Larceny": 4092, "Robbery": 90, "Prostitution": 187, "Motor Vehicle Theft": 883, "Embezzlement": 25, "Trespass": 271, "Rape": 7, "Kidnap": 1, "Runaway": 5}, "97216": {"Homicide": 8, "DUII": 738, "Weapons": 139, "Forgery": 820, "Vandalism": 1628, "Curfew": 54, "Disorderly Conduct": 682, "Offenses Against Family": 2, "Liquor Laws": 250, "Trespass": 681, "Drugs": 817, "Assault, Simple": 700, "Stolen Property": 22, "Aggravated Assault": 393, "Burglary": 1623, "Fraud": 833, "Arson": 3, "Larceny": 6122, "Robbery": 315, "Prostitution": 716, "Motor Vehicle Theft": 1618, "Embezzlement": 53, "Sex Offenses": 19, "Rape": 6, "Kidnap": 9, "Runaway": 6}, "97089": {"Weapons": 1, "Forgery": 1, "Fraud": 1}, "97218": {"Homicide": 10, "DUII": 460, "Weapons": 108, "Forgery": 219, "Vandalism": 1320, "Curfew": 22, "Disorderly Conduct": 549, "Offenses Against Family": 3, "Liquor Laws": 93, "Sex Offenses": 13, "Drugs": 711, "Assault, Simple": 634, "Stolen Property": 29, "Aggravated Assault": 480, "Burglary": 1456, "Fraud": 404, "Arson": 4, "Larceny": 4198, "Robbery": 245, "Prostitution": 25, "Motor Vehicle Theft": 1069, "Embezzlement": 51, "Trespass": 527, "Runaway": 3, "Kidnap": 11, "Rape": 10}, "97219": {"Homicide": 3, "DUII": 736, "Weapons": 33, "Forgery": 258, "Vandalism": 2262, "Curfew": 5, "Disorderly Conduct": 532, "Liquor Laws": 124, "Sex Offenses": 6, "Drugs": 354, "Assault, Simple": 337, "Stolen Property": 6, "Aggravated Assault": 188, "Burglary": 1501, "Fraud": 711, "Arson": 7, "Larceny": 6026, "Robbery": 157, "Prostitution": 3, "Motor Vehicle Theft": 619, "Embezzlement": 68, "Trespass": 431, "Rape": 2, "Kidnap": 4, "Runaway": 2}, "97220": {"Homicide": 21, "DUII": 1267, "Weapons": 249, "Forgery": 1335, "Vandalism": 2860, "Gambling": 2, "Curfew": 91, "Disorderly Conduct": 1238, "Offenses Against Family": 5, "Liquor Laws": 419, "Sex Offenses": 34, "Drugs": 1791, "Assault, Simple": 1377, "Stolen Property": 67, "Aggravated Assault": 851, "Burglary": 2972, "Fraud": 1851, "Arson": 8, "Larceny": 17889, "Robbery": 868, "Prostitution": 966, "Motor Vehicle Theft": 3609, "Embezzlement": 197, "Trespass": 1587, "Rape": 22, "Kidnap": 16, "Runaway": 9}, "97221": {"Disorderly Conduct": 119, "Weapons": 3, "Fraud": 182, "Forgery": 45, "Robbery": 16, "Arson": 1, "Trespass": 71, "Drugs": 45, "DUII": 150, "Assault, Simple": 66, "Stolen Property": 3, "Embezzlement": 17, "Larceny": 1405, "Aggravated Assault": 57, "Vandalism": 362, "Burglary": 418, "Liquor Laws": 17, "Curfew": 2, "Motor Vehicle Theft": 129, "Rape": 1, "Homicide": 2}, "97222": {"Homicide": 1, "Embezzlement": 3, "Fraud": 15, "Liquor Laws": 1, "Robbery": 1, "Trespass": 4, "Drugs": 15, "DUII": 23, "Assault, Simple": 4, "Prostitution": 2, "Motor Vehicle Theft": 14, "Weapons": 3, "Larceny": 93, "Aggravated Assault": 7, "Vandalism": 16, "Burglary": 21, "Forgery": 12, "Disorderly Conduct": 5}, "97223": {"Kidnap": 1, "Fraud": 37, "Forgery": 39, "Vandalism": 44, "Larceny": 324, "Drugs": 8, "DUII": 26, "Assault, Simple": 9, "Motor Vehicle Theft": 36, "Embezzlement": 7, "Trespass": 14, "Aggravated Assault": 7, "Robbery": 20, "Burglary": 31, "Liquor Laws": 3, "Weapons": 1, "Disorderly Conduct": 28}, "97224": {"Trespass": 1, "Fraud": 1, "Larceny": 1}, "97225": {"Fraud": 13, "Liquor Laws": 1, "Robbery": 9, "Forgery": 21, "Drugs": 6, "DUII": 8, "Assault, Simple": 5, "Trespass": 7, "Embezzlement": 1, "Larceny": 42, "Aggravated Assault": 2, "Vandalism": 15, "Motor Vehicle Theft": 4, "Burglary": 16, "Disorderly Conduct": 10}, "97227": {"Homicide": 5, "DUII": 207, "Weapons": 47, "Forgery": 95, "Vandalism": 821, "Gambling": 1, "Curfew": 9, "Disorderly Conduct": 339, "Liquor Laws": 292, "Sex Offenses": 5, "Drugs": 417, "Assault, Simple": 371, "Stolen Property": 7, "Aggravated Assault": 260, "Burglary": 712, "Fraud": 191, "Arson": 5, "Larceny": 3279, "Robbery": 133, "Prostitution": 4, "Motor Vehicle Theft": 506, "Embezzlement": 22, "Trespass": 402, "Runaway": 4, "Kidnap": 5, "Rape": 11}, "97229": {"Weapons": 1, "Fraud": 65, "Forgery": 15, "Robbery": 1, "Trespass": 17, "Drugs": 6, "Stolen Property": 1, "DUII": 21, "Assault, Simple": 8, "Prostitution": 1, "Motor Vehicle Theft": 22, "Embezzlement": 2, "Larceny": 380, "Aggravated Assault": 4, "Vandalism": 144, "Burglary": 124, "Liquor Laws": 2, "Disorderly Conduct": 32}, "97230": {"Homicide": 14, "DUII": 628, "Weapons": 102, "Forgery": 732, "Vandalism": 1882, "Curfew": 28, "Disorderly Conduct": 570, "Offenses Against Family": 2, "Liquor Laws": 73, "Trespass": 583, "Drugs": 430, "Assault, Simple": 638, "Stolen Property": 14, "Aggravated Assault": 447, "Burglary": 1959, "Fraud": 874, "Arson": 12, "Larceny": 8286, "Robbery": 365, "Prostitution": 24, "Motor Vehicle Theft": 2155, "Embezzlement": 89, "Sex Offenses": 14, "Rape": 8, "Kidnap": 11, "Runaway": 5}, "97231": {"Embezzlement": 1, "Fraud": 20, "Liquor Laws": 5, "Robbery": 2, "Arson": 2, "Forgery": 5, "Drugs": 13, "Stolen Property": 1, "DUII": 57, "Assault, Simple": 13, "Motor Vehicle Theft": 31, "Weapons": 3, "Larceny": 289, "Trespass": 17, "Aggravated Assault": 11, "Vandalism": 54, "Burglary": 83, "Curfew": 1, "Disorderly Conduct": 15, "Rape": 2}, "97232": {"Homicide": 12, "DUII": 758, "Weapons": 83, "Forgery": 552, "Vandalism": 1756, "Gambling": 1, "Curfew": 23, "Disorderly Conduct": 830, "Offenses Against Family": 3, "Liquor Laws": 1169, "Trespass": 887, "Drugs": 699, "Assault, Simple": 627, "Stolen Property": 14, "Aggravated Assault": 365, "Burglary": 1362, "Fraud": 862, "Arson": 17, "Larceny": 9670, "Robbery": 415, "Prostitution": 45, "Motor Vehicle Theft": 1485, "Embezzlement": 108, "Sex Offenses": 25, "Runaway": 7, "Kidnap": 8, "Rape": 10}, "97233": {"Homicide": 11, "DUII": 853, "Weapons": 241, "Forgery": 474, "Vandalism": 2388, "Curfew": 76, "Disorderly Conduct": 1020, "Offenses Against Family": 1, "Liquor Laws": 217, "Trespass": 810, "Drugs": 1066, "Assault, Simple": 1097, "Stolen Property": 40, "Aggravated Assault": 718, "Burglary": 2214, "Fraud": 729, "Arson": 13, "Larceny": 6503, "Robbery": 441, "Prostitution": 14, "Motor Vehicle Theft": 2086, "Embezzlement": 42, "Sex Offenses": 25, "Runaway": 12, "Kidnap": 13, "Rape": 19}, "97236": {"Homicide": 9, "DUII": 899, "Weapons": 259, "Forgery": 802, "Vandalism": 3043, "Curfew": 57, "Disorderly Conduct": 1137, "Offenses Against Family": 2, "Liquor Laws": 185, "Sex Offenses": 24, "Drugs": 1184, "Assault, Simple": 1384, "Stolen Property": 55, "Aggravated Assault": 907, "Burglary": 3229, "Fraud": 1286, "Arson": 8, "Larceny": 10918, "Robbery": 636, "Prostitution": 9, "Motor Vehicle Theft": 2841, "Embezzlement": 70, "Trespass": 927, "Runaway": 5, "Kidnap": 17, "Rape": 11}, "97239": {"Homicide": 4, "DUII": 269, "Weapons": 27, "Forgery": 105, "Vandalism": 876, "Curfew": 1, "Disorderly Conduct": 261, "Liquor Laws": 39, "Sex Offenses": 7, "Drugs": 163, "Assault, Simple": 165, "Stolen Property": 5, "Aggravated Assault": 63, "Burglary": 744, "Fraud": 308, "Arson": 5, "Larceny": 3467, "Robbery": 41, "Motor Vehicle Theft": 407, "Embezzlement": 36, "Trespass": 257, "Rape": 1, "Kidnap": 3, "Runaway": 1}, "97113": {"Forgery": 7}, "97123": {"Forgery": 5, "Trespass": 2, "Drugs": 2, "DUII": 1, "Weapons": 1, "Larceny": 3, "Aggravated Assault": 1, "Vandalism": 2, "Burglary": 2, "Disorderly Conduct": 1}, "97124": {"Drugs": 1, "Forgery": 10, "Trespass": 1, "Vandalism": 1, "Larceny": 1}, "97258": {"Fraud": 6, "Forgery": 6, "Assault, Simple": 2, "Motor Vehicle Theft": 6, "Embezzlement": 4, "Larceny": 29, "Trespass": 1, "Aggravated Assault": 1, "Vandalism": 3, "Burglary": 5, "Disorderly Conduct": 2}, "97005": {"Drugs": 2, "Forgery": 11, "Fraud": 4, "Vandalism": 1, "Trespass": 1}, "97006": {"Drugs": 2, "Trespass": 1, "Fraud": 2}, "97007": {"Larceny": 1, "Fraud": 1, "Motor Vehicle Theft": 1}, "97266": {"Homicide": 19, "DUII": 1158, "Weapons": 381, "Forgery": 1604, "Vandalism": 3557, "Gambling": 1, "Curfew": 72, "Disorderly Conduct": 1547, "Offenses Against Family": 2, "Liquor Laws": 379, "Sex Offenses": 39, "Drugs": 2317, "Assault, Simple": 1837, "Stolen Property": 72, "Aggravated Assault": 1142, "Burglary": 3888, "Fraud": 1729, "Arson": 29, "Larceny": 12733, "Robbery": 748, "Prostitution": 476, "Motor Vehicle Theft": 3482, "Embezzlement": 109, "Trespass": 1421, "Runaway": 12, "Kidnap": 20, "Rape": 33}, "97267": {"Drugs": 1, "Forgery": 18, "Larceny": 1, "Fraud": 7, "Trespass": 1}, "97140": {"Larceny": 2}, "97013": {"Larceny": 4, "Fraud": 2, "Liquor Laws": 4, "Trespass": 1, "Drugs": 5, "DUII": 1, "Motor Vehicle Theft": 1, "Forgery": 2, "Burglary": 1, "Disorderly Conduct": 1}, "97015": {"Fraud": 3, "Larceny": 1, "DUII": 1, "Prostitution": 1, "Trespass": 2, "Forgery": 13, "Robbery": 1}, "97023": {"Vandalism": 1}}';
    // $(document).ready(function(){
    //     $.ajax({
    //         type: "POST",
    //         url: "http://153.64.73.150:1080/tdrest/systems/HackSys/queries",
    //         contentType: "application/json",
    //         headers: {
    //             'Accept': "application/vnd.com.teradata.rest-v1.0+json",
    //             'Authorization': 'Basic ' + btoa('hack_user14' + ':' + 'tdhackathon')
    //         },
    //         data: JSON.stringify({
    //             query: "select * from crime_data.portland_crime",
    //             format: "array"
    //         }),
    //         success:function(data){
    //             console.log(data["results"][0]["data"]);
    //             result = data["results"][0]["data"];
    //             crime_by_zipcode = convert_to_crime_by_zipcode(result);
    //             console.log(crime_by_zipcode);
    //         }
    //     });
    // });

    var map;
    var marker;
    var infowindow;
    function initMap() {

        crime_by_zipcode = JSON.parse(json_string);
        console.log(crime_by_zipcode);

      var geocoder = new google.maps.Geocoder();
      var address = "Portland";
      geocoder.geocode({'address': address}, function (results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
          var latLng = new google.maps.LatLng(results[0].geometry.location.lat(), 
            results[0].geometry.location.lng());

          map = new google.maps.Map(document.getElementById('map'), {
            center: latLng,
            zoom: 12
          });

          map.addListener('click', function (event) {
            // alert(event.latLng);
            geocoder.geocode({"location": event.latLng}, function (results, status) {
              if (status == google.maps.GeocoderStatus.OK) {
                var address_components = results[0].address_components;

                var postal_code = undefined;
                for (var i = 0; i < address_components.length; ++i) {
                  if (address_components[i]["types"] == "postal_code")
                    postal_code = address_components[i]["long_name"];
                }

                if (marker != undefined)
                    marker.setMap(null);

                marker = new google.maps.Marker({
                  position: event.latLng,
                  map: map
                });

                infowindow = new google.maps.InfoWindow({
                    content: JSON.stringify(crime_by_zipcode[postal_code])
                });

                marker.addListener('click', function() {
                    infowindow.open(map, marker);
                });
              }
            });
          });

        }
      });
    }

    function convert_to_crime_by_zipcode(data) {
        var crime_by_zipcode = {};
        for (var i = 0; i < data.length; ++i) {
            var address = data[i][4];
            var zipcode = address.slice(address.length - 5);
            if ((zipcode in crime_by_zipcode) == false) 
                crime_by_zipcode[zipcode] = {};
            crime_type = data[i][3];
            if ((crime_type in crime_by_zipcode[zipcode]) == false)
                crime_by_zipcode[zipcode][crime_type] = 0;
            crime_by_zipcode[zipcode][crime_type]++;
        }
        return crime_by_zipcode;
    }

    </script>
    <script async defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBbCPplHphEq_SdUfv-BfeNyoI-5yi8uks&callback=initMap">
    </script>
  </body>
</html>